This is a historical implementation written about 2002, updated 2009 / 2014
